apiVersion: helm.cattle.io/v1
kind: HelmChartConfig
metadata:
  name: traefik
  namespace: kube-system
spec:
  valuesContent: |-
    providers:
      kubernetesGateway:
        enabled: true
        experimentalChannel: true
    experimental:
      kubernetesGateway:
        enabled: true
    service:
      annotations: 
        external-dns.alpha.kubernetes.io/target: "k3s.lab.smig.tech."
    ports:
      rabbitmq:
        port: 5672
        exposedPort: 5672
        protocol: TCP
      cloudflare:
        port: 8085
        expose: 
          default: true
        exposedPort: 8085
        protocol: TCP

    additionalArguments:
      - "--entryPoints.cloudflare.address=:5672"
      - "--entryPoints.cloudflare.address=:8085"
      - "--entryPoints.cloudflare.forwardedHeaders.trustedIPs=103.21.244.0/22,103.22.200.0/22,103.31.4.0/22,141.101.64.0/18,108.162.192.0/18,190.93.240.0/20,188.114.96.0/20,197.234.240.0/22,198.41.128.0/17"
      - "--entryPoints.cloudflare.proxyProtocol.trustedIPs=103.21.244.0/22,103.22.200.0/22,103.31.4.0/22,141.101.64.0/18,108.162.192.0/18,190.93.240.0/20,188.114.96.0/20,197.234.240.0/22,198.41.128.0/17"
